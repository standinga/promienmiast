(ns clojure-noob.core
  (:gen-class))



(defn nazwa [miasto] (nth miasto 0))
(defn lon [miasto] (nth miasto 1))
(defn lat [miasto] (nth miasto 2))
(defn odleglosc [miasto1 miasto2] (+ (* (- (lon miasto2) (lon  miasto1)) (- (lon miasto2) (lon  miasto1))) (* (- (lat miasto2) (lat miasto1)) (- (lat miasto2) (lat miasto1)))))
(defn lmieszk [miasto] (nth miasto 3))

(def miasto ["a" 1 1 10])
(def miasta (list ["a" 1 1 10] ["b" 4 1 10] ["c" 3 5 10] ["d" 2 2 10]))

(defn sumamieszk [listamiast] (if (= () listamiast) 0 (+ (nth (first listamiast) 3) (sumamieszk (rest listamiast)))))

;; filtruje listemiast wzgledem miasta zadanego czy sa wieksze niz dany promien, tworzy liste (miasto x y lmieszk odlegloscod zadanego miasta)


(defn filtrujeodl [listamiast miasto r acc]
  (if (= () listamiast) acc
      (let[odlegloscmiast (odleglosc  miasto (first listamiast)) m (first listamiast)]
           (if
          (> odlegloscmiast r)
        (filtrujeodl (rest listamiast) miasto r acc)
        (filtrujeodl (rest listamiast) miasto r (cons [(nth m 0) (nth m 1) (nth m 2) (nth m 3) odlegloscmiast]  acc))))))

(defn filtrbyr [lista miasto r] (filtrujeodl lista miasto r ()))


;;(defn filtrujepoodl [listamiast miasto r] (filter (fn [x] (< (odleglosc  miasto x) r)) listamiast))

(defn odl [miasto] (nth miasto 4))
(defn sortbyodl [lista] (sort-by odl lista))


(defn main [listamiast miastawszystkie r accmain granica]
  (if (= () listamiast)
    accmain
    (let [miasto (first listamiast)]
      (let [filteredbyr (filtrbyr miastawszystkie miasto r)]
        (if (<= (sumamieszk filteredbyr) granica)
          (main (rest listamiast) miastawszystkie r accmain granica)
            (let [sortedbyodl (sortbyodl filteredbyr)]
              (letfn [(aux [lista suma acc]
                           (let [m (first lista)]
                             (if (> (+ (lmieszk m) suma) granica)
                            (main (rest listamiast) miastawszystkie (odl m) (cons m acc) granica)
                            (aux (rest lista) (+ (lmieszk m) suma) (cons m acc)))))]

              (aux sortedbyodl 0 ())
              )))))))

(defn promien [listamiast]
  (main listamiast listamiast 10000000 () (quot (sumamieszk listamiast) 2)))


(promien miasta)

(def miasta2 (list ["A" 1 1 10] ["B" 2 2 10] ["C" 2 6 10] ["D" 4 4 10] ["E" 5 8 10] ["F" 7 3 10] ["G" 6 1 10] ["H" 10 1 10] ["I" 9 6 10] ["J" 5 6 10]))
(promien miasta2)

(promien (list ["A" 1 1 10] ["B" 4 1 10] ["C" 7 1 10] ["D" 5 6 10] ["E" 6 7 10] ["F" 7 6 10] ["G" 6 5 10]))

(def miasta3 (list ["Zywiec" 49870 19180 32341] ["Zyrardow" 52060 20450 41318] ["Zychlin" 52250 19620 8688] ["Zory" 50069 18689 62052] ["Znin" 52850 17709 14281] ["Zary" 51649 15130 39066] ["Zagan" 51619 15299 26653] ["Zlotow" 53359 17030 18757] ["Zlotoryja" 51119 15909 16406] ["Zlocieniec" 53529 16000 13331] ["Ziebice" 50599 17050 9200] ["Zielonka" 52299 21169 17394] ["Zielona Gora" 51940 15489 119023] ["Zgorzelec" 51149 15009 32278] ["Zgierz" 51869 19410 57803] ["Zdzieszowice" 50419 18120 12087] ["Zdunska Wola" 51609 18940 43920] ["Zabkowice Slaskie" 50590 16819 15835] ["Zabki" 52290 21110 30879] ["Zawiercie" 50489 19420 51688] ["Zawadzkie" 50619 18459 7703] ["Zamosc" 50729 23260 65612] ["Zambrow" 52980 22239 22643] ["Zakopane" 49289 19959 27837] ["Zabrze" 50299 18779 179452] ["Wyszkow" 52599 21449 27309] ["Wysokie Mazowieckie" 52910 22509 9470] ["Wschowa" 51799 16319 14322] ["Wrzesnia" 52320 17579 29564] ["Wronki" 52700 16360 11615] ["Wroclaw" 51110 17030 631188] ["Wolow" 51329 16629 12640] ["Wolomin" 52339 21229 37459] ["Wolsztyn" 52109 16109 13662] ["Wolbrom" 50390 19770 8926] ["Wojkowice" 50360 19010 9172] ["Wodzislaw Slaski" 50039 18400 49238] ["Wloszczowa" 50860 19969 10675] ["Wlodawa" 51549 23559 13719] ["Wloclawek" 52659 19059 115546] ["Wladyslawowo" 54789 18400 15382] ["Wisla" 49659 18870 11333] ["Wielun" 51219 18569 23837] ["Wieliczka" 49990 20090 20988] ["Wegrow" 52399 22010 12783] ["Wegorzewo" 54220 21749 11774] ["Wejherowo" 54599 18230 50375] ["Wagrowiec" 52810 17200 25276] ["Wabrzezno" 53280 18940 14114] ["Warszawa" 52259 21020 1715517] ["Warka" 51799 21190 11666] ["Walcz" 53270 16470 26417] ["Walbrzych" 50780 16280 119171] ["Wadowice" 49879 19489 19356] ["Ustrzyki Dolne" 49430 22610 9521] ["Ustron" 49719 18799 16002] ["Ustka" 54580 16850 16379] ["Tychy" 50160 19000 129112] ["Turek" 52020 18479 28655] ["Tuchola" 53589 17850 13990] ["Trzebnica" 51310 17060 12741] ["Trzebinia" 50160 19450 20309] ["Trzebiatow" 54069 15260 10250] ["Trzcianka" 53040 16459 17382] ["Torun" 53020 18609 204299] ["Tomaszow Mazowiecki" 51540 20030 65454] ["Tomaszow Lubelski" 50459 23419 20209] ["Tczew" 54099 18779 60769] ["Tarnow" 50009 20990 112952] ["Tarnowskie Gory" 50459 18860 61002] ["Tarnobrzeg" 50590 21680 48558] ["Swinoujscie" 53909 14249 41509] ["Swietochlowice" 50290 18940 52372] ["Swiecie" 53400 18440 26482] ["Swiebodzin" 52259 15529 22109] ["Swiebodzice" 50860 16329 23306] ["Swidwin" 53770 15779 15798] ["Swidnik" 51219 22790 40373] ["Swidnica" 50849 16489 59737] ["Sroda Wielkopolska" 52220 17270 22425] ["Srem" 52090 17010 30350] ["Szydlowiec" 51229 20859 12142] ["Szubin" 53010 17719 9487] ["Sztum" 53849 18959 10377] ["Szprotawa" 51569 15520 12445] ["Szczytno" 53559 20990 24805] ["Szczecinek" 53710 16689 40723] ["Szczecin" 53430 14529 408913] ["Szamotuly" 52610 16580 19001] ["Sycow" 51300 17709 10452] ["Swarzedz" 52409 17069 31100] ["Suwalki" 54109 22940 69404] ["Sulecin" 52450 15109 10277] ["Sulejowek" 52250 21270 19328] ["Sulechow" 52090 15620 17680] ["Suchedniow" 51069 20830 8747] ["Sucha Beskidzka" 49750 19590 9499] ["Strzelin" 50780 17069 12575] ["Strzelce Opolskie" 50520 18299 18610] ["Strzelce Krajenskie" 52869 15529 10212] ["Strzegom" 50959 16350 16881] ["Staszow" 50560 21180 15517] ["Stary Sacz" 49570 20640 9121] ["Starogard Gdanski" 53970 18520 48808] ["Stargard Szczecinski" 53340 15020 69724] ["Starachowice" 51060 21070 51695] ["Stalowa Wola" 50570 22049 64189] ["Sosnowiec" 50279 19120 213513] ["Sopot" 54439 18559 38217] ["Solec Kujawski" 53069 18230 15697] ["Sokolka" 53400 23500 18902] ["Sokolow Podlaski" 52409 22239 18732] ["Sochaczew" 52230 20229 37729] ["Slupsk" 54470 17019 94849] ["Slupca" 52290 17879 14063] ["Slubice" 52359 14569 16902] ["Slawno" 54349 16670 12992] ["Skwierzyna" 52589 15489 9941] ["Skoczow" 49800 18799 14868] ["Skierniewice" 51959 20139 48695] ["Skawina" 49979 19830 24280] ["Skarzysko-Kamienna" 51119 20879 47987] ["Sierpc" 52860 19650 18632] ["Sieradz" 51600 18740 43651] ["Siemiatycze" 52419 22870 14851] ["Siemianowice Slaskie" 50330 19049 69539] ["Siedlce" 52169 22280 76393] ["Sepolno Krajenskie" 53449 17530 9332] ["Sanok" 49570 22209 39375] ["Sandomierz" 50689 21740 24731] ["Rzeszow" 50049 21999 182028] ["Rypin" 53069 19410 16859] ["Ryki" 51639 21929 9989] ["Rydultowy" 50069 18429 21928] ["Rybnik" 50100 18549 140789] ["Rumia" 54590 18370 47304] ["Ruda Slaska" 50299 18880 142346] ["Ropczyce" 50069 21749 15655] ["Rogozno" 52750 16979 11158] ["Reda" 54620 18340 22479] ["Rawicz" 51609 16860 20994] ["Rawa Mazowiecka" 51770 20260 17819] ["Radzyn Podlaski" 51790 22620 16298] ["Radzionkow" 50390 18889 17141] ["Radomsko" 51069 19440 47947] ["Radom" 51399 21159 219703] ["Radlin" 50039 18459 18146] ["Raciborz" 50090 18219 56084] ["Pyskowice" 50410 18620 18704] ["Pyrzyce" 53139 14879 12875] ["Pultusk" 52710 21089 19191] ["Pulawy" 51430 21980 49456] ["Puck" 54709 18400 11520] ["Pszow" 50039 18400 14269] ["Pszczyna" 49979 18950 26003] ["Przeworsk" 50069 22500 15915] ["Przemysl" 49790 22780 64276] ["Przasnysz" 53010 20879 17430] ["Pruszkow" 52220 20819 59025] ["Pruszcz Gdanski" 54255 18649 28621] ["Prudnik" 50330 17569 21979] ["Poznan" 52399 16900 550742] ["Poreba" 50489 19339 8833] ["Poniatowa" 51180 22120 9776] ["Polczyn-Zdroj" 53770 16100 8529] ["Polaniec" 50429 21280 8328] ["Polkowice" 51500 16049 22691] ["Police" 53549 14559 33816] ["Plonsk" 52629 20379 22597] ["Plock" 52550 19700 123627] ["Pleszew" 51909 17779 17862] ["Pisz" 53630 21799 19547] ["Piotrkow Trybunalski" 51409 19700 76404] ["Pionki" 51490 21459 19550] ["Pinczow" 50539 20529 11471] ["Pila" 53149 16739 74930] ["Pieszyce" 50720 16590 9678] ["Piekary Slaskie" 50400 18959 57502] ["Piastow" 52209 20920 22914] ["Piaseczno" 52069 21020 44017] ["Paslek" 54069 19659 12421] ["Parczew" 51639 22900 10951] ["Pabianice" 51669 19350 68321] ["Ozorkow" 51969 19290 20286] ["Ozimek" 50689 18219 9283] ["Otwock" 52109 21280 44944] ["Oswiecim" 50039 19259 39893] ["Ostrzeszow" 51419 17950 14546] ["Ostrow Wielkopolski" 51660 17799 72933] ["Ostroda" 53710 19959 34047] ["Ostrowiec Swietokrzyski" 50950 21389 72871] ["Ostroleka" 53090 21569 53287] ["Orzesze" 50160 18779 19823] ["Orneta" 54119 20129 9169] ["Opole Lubelskie" 51149 21969 8901] ["Opole" 50679 17940 121576] ["Opoczno" 51379 20280 22318] ["Opalenica" 52310 16399 9534] ["Olawa" 50940 17299 32091] ["Olsztyn" 53779 20489 174641] ["Olkusz" 50279 19549 36993] ["Olesnica" 51209 17379 37334] ["Olesno" 50889 18409 9574] ["Olecko" 54040 22509 16556] ["Oborniki" 52650 16809 18451] ["Nysa" 50479 17339 45232] ["Nowy Tomysl" 52310 16120 15024] ["Nowy Targ" 49489 20030 33804] ["Nowy Sacz" 49630 20699 84129] ["Nowy Dwor Mazowiecki" 52429 20709 28261] ["Nowy Dwor Gdanski" 54220 19120 10171] ["Nowogard" 53660 15109 16974] ["Nowe Miasto Lubawskie" 53430 19590 11224] ["Nowa Sol" 51809 15709 40022] ["Nowa Ruda" 50590 16500 23475] ["Nowa Deba" 50439 21759 11507] ["Nisko" 50529 22139 15479] ["Nidzica" 53369 20429 14395] ["Namyslow" 51079 17719 16138] ["Naklo nad Notecia" 53139 17599 19294] ["Mysliborz" 52929 14869 11672] ["Myslenice" 49839 19939 18383] ["Myszkow" 50580 19319 32694] ["Myslowice" 50240 19140 75305] ["Murowana Goslina" 52580 17010 10437] ["Mragowo" 53880 21300 22251] ["Mosina" 52259 16840 12941] ["Morag" 53919 19930 14458] ["Monki" 53400 22780 10396] ["Mogilno" 52650 17960 12466] ["Mlawa" 53120 20360 30969] ["Minsk Mazowiecki" 52179 21559 39668] ["Milicz" 51530 17270 11874] ["Milanowek" 52130 20659 16387] ["Mikolow" 50230 18969 39597] ["Miedzyrzecz" 52450 15569 18610] ["Miedzyrzec Podlaski" 51990 22780 17223] ["Miedzychod" 52610 15899 10913] ["Mielec" 50290 21430 61238] ["Miechow" 50360 20019 11845] ["Miastko" 54000 16969 11051] ["Marki" 52329 21110 28288] ["Malbork" 54040 19040 39252] ["Makow Mazowiecki" 52860 21100 10211] ["Lukow" 51940 22390 30827] ["Lodz" 51770 19459 718960] ["Lomza" 53180 22070 62812] ["Lomianki" 52349 20889 16600] ["Lobez" 53640 15620 10549] ["Leczyca" 52069 19199 14905] ["Leczna" 51310 22870 20317] ["Laziska Gorne" 50170 18779 22467] ["Lask" 51600 19140 18202] ["Lapy" 52989 22890 16124] ["Lancut" 50069 22229 18143] ["Lwowek Slaski" 51110 15600 9338] ["Lubsko" 51790 14960 14646] ["Lubon" 52339 16870 30297] ["Lubliniec" 50669 18689 24394] ["Lublin" 51240 22570 347678] ["Lubin" 51399 16200 74669] ["Lubawa" 53500 19749 10059] ["Lubartow" 51459 22610 22654] ["Luban" 51119 15280 22108] ["Lubaczow" 50160 23119 12552] ["Lipno" 52839 19169 15077] ["Limanowa" 49709 20419 15132] ["Lidzbark Warminski" 54139 20590 16539] ["Libiaz" 50100 19290 17374] ["Ledziny" 50130 19059 16665] ["Lebork" 54549 17750 35588] ["Lezajsk" 50259 22420 14448] ["Leszno" 51849 16570 64722] ["Legnica" 51209 16159 102422] ["Legionowo" 52409 20920 54109] ["Kwidzyn" 53740 18930 38931] ["Kutno" 52240 19360 45975] ["Kudowa-Zdroj" 50429 16229 10350] ["Krzeszowice" 50130 19630 10281] ["Kruszwica" 52680 18299 9214] ["Krotoszyn" 51700 17430 29577] ["Krosno Odrzanskie" 52060 15100 12038] ["Krosno" 49700 21759 47307] ["Krasnik" 50929 22219 36038] ["Krasnystaw" 50990 23179 19588] ["Krapkowice" 50479 17960 17137] ["Krakow" 50060 19959 758463] ["Kozuchow" 51750 15600 9718] ["Kozienice" 51590 21550 18422] ["Kowary" 50799 15829 11648] ["Koscierzyna" 54130 17970 23779] ["Koscian" 52090 16639 24050] ["Koszalin" 54189 16180 109343] ["Kostrzyn" 52589 14649 9426] ["Koronowo" 53310 17929 11360] ["Konskie" 51200 20399 20530] ["Konstantynow Lodzki" 51750 19319 17757] ["Konstancin-Jeziorna" 52099 21110 17473] ["Konin" 52209 18249 77847] ["Kolobrzeg" 54189 15569 46951] ["Kolo" 52199 18639 23064] ["Koluszki" 51750 19819 13542] ["Kolno" 53419 21929 10679] ["Kobylka" 52339 21200 20458] ["Knurow" 50220 18669 39320] ["Klodzko" 50439 16659 28356] ["Klobuck" 50909 18940 13281] ["Kluczbork" 50980 18209 24707] ["Kielce" 50889 20649 200938] ["Kety" 49870 19219 19151] ["Ketrzyn" 54079 21370 28256] ["Kepno" 51280 18000 14657] ["Kedzierzyn-Kozle" 50340 18209 63635] ["Katowice" 50259 19020 307233] ["Kartuzy" 54329 18200 15007] ["Karczew" 52080 21249 10177] ["Kamien Pomorski" 53970 14779 9190] ["Kamienna Gora" 50790 16030 20342] ["Kalisz" 51770 18100 104676] ["Kalety" 50570 18899 8658] ["Jozefow" 52150 21260 19947] ["Jozefow" 52150 21260 2520] ["Jedrzejow" 50650 20299 15982] ["Jelenia Gora" 50909 15729 82846] ["Jelcz-Laskowice" 51029 17299 15864] ["Jaworzno" 50209 19270 94305] ["Jawor" 51060 16200 24096] ["Jastrzebie-Zdroj" 49990 18590 91723] ["Jaslo" 49739 21469 36641] ["Jaroslaw" 50020 22679 39426] ["Jarocin" 51979 17499 26278] ["Janow Lubelski" 50710 22410 12145] ["Janikowo" 52429 17030 9145] ["Inowroclaw" 52780 18249 75517] ["Ilawa" 53589 19560 33360] ["Hrubieszow" 50810 23889 18731] ["Hajnowka" 52729 23579 21834] ["Gubin" 51959 14719 17019] ["Gryfino" 53229 14479 21589] ["Gryfice" 53919 15190 17016] ["Grudziadz" 53490 18749 97971] ["Grojec" 51879 20859 16333] ["Grodzisk Wielkopolski" 52230 16360 14265] ["Grodzisk Mazowiecki" 52109 20620 29763] ["Grodkow" 50700 17370 8900] ["Grajewo" 53650 22440 22375] ["Gora Kalwaria" 51990 21209 11651] ["Gora" 51669 16520 12492] ["Gostyn" 51879 17000 20183] ["Gostynin" 53430 19430 19205] ["Gorzow Wielkopolski" 52740 15230 124609] ["Gorlice" 49670 21159 28555] ["Goldap" 54310 22309 13791] ["Golub-Dobrzyn" 53110 19040 13014] ["Goleniow" 53570 14819 22846] ["Gniezno" 52530 17610 70141] ["Glucholazy" 50320 17370 14382] ["Glubczyce" 50189 17830 13052] ["Glowno" 51979 19700 14966] ["Glogow" 51669 16080 69185] ["Gliwice" 50310 18669 186210] ["Gizycko" 54040 21759 30096] ["Gdynia" 54520 18530 248726] ["Gdansk" 54360 18639 460427] ["Garwolin" 51909 21620 17147] ["Elk" 53830 22359 59646] ["Elblag" 54179 19399 123659] ["Dzierzoniow" 50729 16650 34679] ["Dzialdowo" 53229 20180 21589] ["Drezdenko" 52829 15829 10491] ["Drawsko Pomorskie" 53529 15800 11895] ["Dobre Miasto" 53990 20390 10661] ["Debno" 52740 14699 14124] ["Deblin" 51569 21830 17267] ["Debica" 50060 21420 47180] ["Dabrowa Tarnowska" 50179 21000 11861] ["Dabrowa Gornicza" 50330 19180 124701] ["Darlowo" 54419 16410 14308] ["Czluchow" 53670 17350 14536] ["Czestochowa" 50810 19129 234472] ["Czerwionka-Leszczyny" 50170 18680 28534] ["Czersk" 53800 17970 10045] ["Czeladz" 50320 19129 33345] ["Czechowice-Dziedzice" 49910 19020 35543] ["Czarnkow" 52910 16549 11305] ["Czarna Bialostocka" 53589 22579 9737] ["Cieszyn" 49750 18629 36119] ["Ciechocinek" 52880 18790 10791] ["Ciechanow" 52880 20620 44974] ["Chrzanow" 50139 19399 38420] ["Choszczno" 53180 15400 15800] ["Chorzow" 50299 19030 111168] ["Chojnow" 51280 15930 14210] ["Chojnice" 53700 17569 40306] ["Chodziez" 52989 16910 19651] ["Chelmza" 53180 18609 15066] ["Chelmno" 53350 18429 20813] ["Chelmek" 50110 19249 9216] ["Chelm" 51139 23490 65897] ["Bytow" 54179 17470 17002] ["Bytom" 50349 18909 174724] ["Bystrzyca Klodzka" 50299 16639 10552] ["Bydgoszcz" 53120 18010 361254] ["Busko-Zdroj" 50479 20719 16860] ["Bukowno" 50290 19440 10488] ["Brzeziny" 51809 19749 12587] ["Brzeszcze" 49990 19149 11691] ["Brzesko" 49969 20600 17193] ["Brzeg Dolny" 51270 16739 12657] ["Brzeg" 50849 17470 37261] ["Brwinow" 52179 20799 13002] ["Brodnica" 53259 19399 28580] ["Braniewo" 54390 19819 17455] ["Boleslawiec" 51259 15560 39851] ["Boguszow-Gorce" 50760 16189 16417] ["Bogatynia" 50919 14960 18566] ["Bochnia" 49979 20429 30303] ["Blonie" 52199 20620 12602] ["Blachownia" 50790 18959 9863] ["Biskupiec" 53870 20950 10669] ["Bilgoraj" 50539 22729 27252] ["Bierun" 50100 19100 19681] ["Bielsko-Biala" 49819 19049 174370] ["Bielsk Podlaski" 52780 23290 26525] ["Bielawa" 50689 16610 31480] ["Bialystok" 53139 23159 294921] ["Bialogard" 54009 15979 24794] ["Biala Podlaska" 52039 23110 57990] ["Bedzin" 50340 19129 58735] ["Belchatow" 51369 19360 60032] ["Bartoszyce" 54249 20809 24719] ["Barlinek" 52999 15199 14277] ["Augustow" 53839 23000 30809] ["Andrychow" 49860 19339 21239] ["Aleksandrow Lodzki" 51820 19299 21184] ["Aleksandrow Kujawski" 52880 18700 12540]))

(promien miasta3)
